---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit 01-occurrence-data.md in _episodes_rmd/
source: Rmd
title: "occurrence data"
teaching: 10
exercises: 5

objectives:
- "Download occurrence data through API."
- "Filter occurrance data."

---

## 2 Occurrence data  
#### 2.1 Download occurrence data  

(fix me) add a decription about biodiversity databases; a figure about GBIF; a list of databases; what is api;

For our example, we download occurrence data for the nine-banded armadillo from GBIF.org (Global Biodiversity Information Facility). 


```r
library("raster")
library("dismo")
library("rgeos")
library("rgdal")
library("sp")
library("ENMeval")
```

#####Thread 6

```r
require(jsonlite)

# gbif is a function in dismo package, which directly download occurrences through GBIF api
gbif(genus="Dasypus",species="novemcinctus",download=FALSE)
```

```
## [1] 7508
```

```r
# download the first 1000 record ()
occ_raw <- gbif(genus="Dasypus",species="novemcinctus",download=TRUE,
                start=1,end=1000) # the default is to download all
#save(occ_raw,file = "data/occ_raw")
#write.csv("data/occ_raw.csv")

# to view the first few records the occurrence dataset use:
#head( occ_raw )
```


(fix me) add a list of packages and biodiversity databases;  
| database | R package |  
| -------- | --------- |   
| BIEN | [BIEN](https://cran.r-project.org/web/packages/BIEN/vignettes/BIEN_tutorial.html) |  
| BISON | [rbison](~~~~~~~~add link here) |  
| eBird | [rebird]() |  
| GBIF |[rgbif]()|
| iNaturalist | [rinat]() |
| VertNet | [rvertnet]() |
| iDigBio  | [ridigbio]() |  

| database        | R package           |
| ------------- |-------------|  
| BIEN | [BIEN](https://cran.r-project.org/web/packages/BIEN/vignettes/BIEN_tutorial.html) |  
| BISON | [rbison](~~~~~~~~add link here) |  
| eBird | [rebird]() |  
| GBIF |[rgbif]()|
| iNaturalist | [rinat]() |
| VertNet | [rvertnet]() |
| iDigBio  | [ridigbio]() | 



| Tables        | Are           | Cool  |
| ------------- |:-------------:| -----:|
| col 3 is      | right-aligned | $1600 |
| col 2 is      | centered      |   $12 |
| zebra stripes | are neat      |    $1 |



(fix me) the great thing is, you could query many databases at one time:  
spocc package  
developed by *rOpenSci*  

https://github.com/ropensci/spocc  
https://ropensci.github.io/spocc/  




> ## Challenge: check if packages are setup?
> > ## Solution
> > Run a simple Maxent model from R terminal:
> > 
> > ```r
> > # get predictor variables
> > fnames <- list.files(path=paste(system.file(package="dismo"), '/ex', sep=''),
> >               pattern='grd', full.names=TRUE )
> > predictors <- stack(fnames)
> > # file with presence points
> > occurence <- paste(system.file(package="dismo"), '/ex/bradypus.csv', sep='')
> > occ <- read.table(occurence, header=TRUE, sep=',')[,-1]
> > # witholding a 20% sample for testing
> > fold <- kfold(occ, k=5)
> > occtest <- occ[fold == 1, ]
> > occtrain <- occ[fold != 1, ]
> > # fit model, biome is a categorical variable
> > me <- maxent(predictors, occtrain, factors='biome')
> > # see the maxent results in a browser:
> > me
> > ```
> {: .solution}
{: .challenge}
{% include links.md %}
